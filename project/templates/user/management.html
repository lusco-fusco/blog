{% extends 'layout.html' %}

{% block content %}
    <script>
      $(function() {
        $('a.delete').bind('click', function() {
            $.ajax({
                url: '/user/' + $(this).attr('id'),
                type: 'DELETE',
                success: function(result) {
                    location.reload();
                }
            });
        });
      });

      $(function() {
        $('a.restore').bind('click', function() {
            $.ajax({
                url: '/user/' + $(this).attr('id') + '/restore',
                type: 'PATCH',
                success: function(result) {
                    location.reload();
                }
            });
        });
      });
    </script>

    <!-- User table -->
    <table>
        <tr>
            <th>email</th>
            <th>First name</th>
            <th>Last name</th>
            <th>role</th>
            <th>enabled?</th>
            <th>actions</th>
        </tr>
        {% for user in users %}
            <tr>
                <td><span>{{ user.email }}</span></td>
                <td><span>{{ user.first_name }}</span></td>
                <td><span>{{ user.last_name }}</span></td>
                <td><span>{{ user.role.name }}</span></td>
                <td><span>{{ user.enabled }}</span></td>
                <td>
                    {% if user.enabled %}
                        <a href="#" class="delete" id={{user.id}}>delete</a>
                    {% else %}
                        <a href="#" class="restore" id={{user.id}}>restore</a>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </table>
{% endblock %}